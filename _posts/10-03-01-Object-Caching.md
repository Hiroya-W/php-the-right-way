---
isChild: true
---

## オブジェクトキャッシュ

コード内の個々のオブジェクトをキャッシュできれば便利なこともある。
持ってくるのにコストがかかるデータや、結果がほとんど変わらないデータベースへの問い合わせなどだ。
オブジェクトキャッシュ用のソフトウェアを使えば、こういったデータをメモリ上に保持でき、
その後のアクセスの高速化につながる。
一度取得したデータをどこかに格納しておいて、それ以降のリクエストではそこから直接取り出す。
そうすればパフォーマンスは劇的に向上するし、データベースサーバーにかかる負荷も減らせる。

バイトコードキャッシュ用ソリューションの多くはカスタムデータも同様にキャッシュできるので、さらに活用できる。
APC や XCache そして WinCache はすべて API を提供しており、PHP コードのデータをメモリキャッシュに格納できる。

オブジェクトキャッシュシステムとして最もよく使われているのは APC と memcached だ。
APC はオブジェクトキャッシュの選択肢として最適で、
シンプルな API を使ってデータをメモリキャッシュに格納できる。
セットアップも簡単で、すぐに使えるようになる。
APC の制約のひとつは、インストールしたサーバーと密接に結合してしまうことだ。
一方、Memcached は個別のサービスとしてインストールするものであり、
ネットワーク越しにアクセスできる。つまり、
中央で管理している超高速なストレージにオブジェクトを格納して、
いろんなシステムからそれを取り出せるということだ。

ネットワーク環境において、アクセス速度の面では APC のほうが memcached より優れている。
しかし、memcached のほうが、より手軽にスケールアップできる。
複数のサーバーを使う予定がないとか memcached の追加機能が不要だという場合は、
オブジェクトキャッシュに APC を選ぶのが最適だろう。

APC を使うロジックの例を示す。

{% highlight php %}
<?php
$data = apc_fetch('expensive_data');
if (!$data)
{
	$data = get_expensive_data();
	apc_store('expensive_data', $data);
}
{% endhighlight %}

オブジェクトキャッシュシステムについて詳しく知りたい場合は、これらが参考になる。

* [APC 関数](http://php.net/manual/ja/ref.apc.php)
* [Memcached](http://memcached.org/)
* [Redis](http://redis.io/)
* [XCache API](http://xcache.lighttpd.net/wiki/XcacheApi)
* [WinCache 関数](http://www.php.net/manual/ja/ref.wincache.php)
